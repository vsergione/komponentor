{"version":3,"sources":["komponentor.router.js"],"names":["$","Router","routes","currentRoute","defaultRoute","container","options","debug","autoInit","log","args","console","init","Object","assign","this","window","addEventListener","handleRoute","e","Error","stack","split","trim","preventDefault","route","path","handler","url","parseRoute","hash","location","substring","paramPairs","params","forEach","pair","key","value","async","keys","sort","i","length","match","RegExp","navigate","empty","componentEl","attr","appendTo","komponent","data","error","paramString","entries","map","join","getCurrentRoute","KomponentorRouter","document","ready","komponentor","jQuery"],"mappings":"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","file":"komponentor.router.min.js","sourcesContent":["/**\n * Komponentor Router - Hash-based routing system\n * @module komponentor-router\n */\n\n(function($) {\n    'use strict';\n\n    const Router = {\n        routes: {},\n        currentRoute: null,\n        defaultRoute: null,\n        container: null,\n        options: {\n            debug: false,\n            autoInit: true\n        }\n    };\n\n    // Logging utility\n    const log = (...args) => {\n        if (Router.options.debug) {\n            console.log('[KomponentorRouter]', ...args);\n        }\n    };\n\n    /**\n     * Initialize the router\n     * @param {Object} options Router configuration\n     * @param {string} options.container Container selector where components will be rendered\n     * @param {boolean} options.debug Enable debug logging\n     * @param {string} options.defaultRoute Default route when none specified\n     */\n    Router.init = function(options = {}) {\n        Object.assign(this.options, options);\n        \n        if (options.container) {\n            this.container = $(options.container);\n        }\n        \n        if (options.defaultRoute) {\n            this.defaultRoute = options.defaultRoute;\n        }\n\n        // Handle initial route\n        window.addEventListener('load', () => this.handleRoute());\n\n        // Handle route changes\n        window.addEventListener('hashchange', (e) => {\n           log('Route handler called from:', new Error().stack.split('\\n')[2].trim());\n\n            e.preventDefault();\n            this.handleRoute();\n        });\n\n        log('Router initialized', this.options);\n        return this;\n    };\n\n    /**\n     * Add a route handler\n     * @param {string} path Route path\n     * @param {Object|Function} handler Route handler or component config\n     */\n    Router.route = function(path, handler) {\n        if (typeof handler === 'string') {\n            // If handler is a string, treat it as a component URL\n            handler = { url: handler };\n        }\n\n        this.routes[path] = handler;\n        log('Route added', path, handler);\n        return this;\n    };\n\n    /**\n     * Parse the current hash location\n     * @returns {Object} Parsed route data\n     */\n    Router.parseRoute = function() {\n        const hash = window.location.hash.substring(1) || this.defaultRoute || '';\n        const [path, ...paramPairs] = hash.split('|');\n        const params = {};\n        \n        paramPairs.forEach(pair => {\n            const [key, value] = pair.split('=');\n            params[key] = value;\n        });\n\n        return {\n            path,\n            params,\n            hash: hash\n        };\n    };\n\n    /**\n     * Handle route change\n     */\n    Router.handleRoute = async function() {\n        const route = this.parseRoute();\n        \n        // Exit if hash hasn't changed from current route\n        if (this.currentRoute && this.currentRoute.hash === route.hash) {\n            log('Hash unchanged, skipping route handling');\n            return;\n        }\n\n        let handler = null;\n        const routes = Object.keys(this.routes).sort();\n        for(let i=0;i<routes.length;i++) {\n            if(route.path.match(new RegExp(\"^\"+routes[i]+\"$\"))) {\n                handler = this.routes[routes[i]];\n                break;\n            }\n        }\n\n        log('Handling route', route,handler);\n\n        if (!handler) {\n            log('No handler found for route', route.path);\n            if (this.defaultRoute && route.path !== this.defaultRoute) {\n                this.navigate(this.defaultRoute);\n            }\n            return;\n        }\n\n        try {\n            if (typeof handler === 'function') {\n                // Execute function handler\n                await handler(route);\n            } else if (typeof handler === 'object') {\n                // Load component\n                if (!this.container) {\n                    throw new Error('No container specified for component rendering');\n                }\n\n                // Clear previous component\n                this.container.empty();\n\n                // Create component element\n                const componentEl = $('<div>')\n                    .attr('is', 'komponent')\n                    .appendTo(this.container);\n\n                // Load component with route params\n                await componentEl.komponent({\n                    ...handler,\n                    data: {\n                        ...handler.data,\n                        ...route.params\n                    }\n                });\n            }\n\n            this.currentRoute = route;\n            log('Route handled successfully', route);\n        } catch (error) {\n            console.error('Error handling route:', error);\n        }\n    };\n\n    /**\n     * Navigate to a route\n     * @param {string} path Route path\n     * @param {Object} params Route parameters\n     */\n    Router.navigate = function(path, params = {}) {\n        const paramString = Object.entries(params)\n            .map(([key, value]) => `${key}=${value}`)\n            .join('|');\n\n        const hash = paramString ? `${path}|${paramString}` : path;\n        window.location.hash = hash;\n    };\n\n    /**\n     * Get current route information\n     * @returns {Object} Current route data\n     */\n    Router.getCurrentRoute = function() {\n        return this.currentRoute;\n    };\n\n    // Export router to global scope\n    window.KomponentorRouter = Router;\n\n    // Auto-initialize if enabled\n    $(document).ready(() => {\n        // Wait for komponentor to be available\n        if (typeof window.komponentor === 'undefined') {\n            console.error('Komponentor not found. Make sure komponentor.modern.js is loaded first.');\n            return;\n        }\n\n        if (Router.options.autoInit) {\n            Router.init();\n        }\n    });\n\n})(jQuery); "]}