/*! komponentor v1.0.0
 * A jQuery plugin to create modular web apps
 * (c) 2025 
 * Released under the MIT License
 */
!function(t){const o={routes:{},currentRoute:null,defaultRoute:null,container:null,options:{accessControl:t=>!0,debug:!1,autoInit:!0}},e=(...t)=>{o.options.debug&&console.log("[KomponentorRouter]",...t)};o.init=function(o={}){return Object.assign(this.options,o),o.container&&(this.container=t(o.container)),o.defaultRoute&&(this.defaultRoute=o.defaultRoute),window.addEventListener("load",(()=>this.handleRoute())),window.addEventListener("hashchange",(t=>{e("Route handler called from:",(new Error).stack.split("\n")[2].trim()),t.preventDefault(),this.handleRoute()})),e("Router initialized",this.options),this},o.route=function(t,o){return"string"==typeof o&&(o={url:o}),this.routes[t]=o,e("Route added",t,o),this},o.parseRoute=function(){const t=window.location.hash.substring(1)||this.defaultRoute||"",[o,...e]=t.split("|"),n={};return e.forEach((t=>{const[o,e]=t.split("=");n[o]=e})),{path:o,params:n,hash:t}},o.handleRoute=async function(){const o=this.parseRoute();if(this.currentRoute&&this.currentRoute.hash===o.hash)return void e("Hash unchanged, skipping route handling");let n=null;const i=Object.keys(this.routes).sort().reverse();for(let t=0;t<i.length;t++)if(o.path.match(new RegExp("^"+i[t]+"$"))){n=this.routes[i[t]];break}if(this.options.accessControl){if(!await this.options.accessControl(o))return void e("Access denied for route",o.path)}if(e("Handling route",o,n),!n)return e("No handler found for route",o.path),void(this.defaultRoute&&o.path!==this.defaultRoute&&this.navigate(this.defaultRoute));try{if("function"==typeof n&&(n=await n(o)),e("handler",n),"object"==typeof n){if(!this.container)throw new Error("No container specified for component rendering");this.container.empty();const e=t("<komponent>").appendTo(this.container);await e.komponent({...n,data:{...n.data,...o.params}})}this.currentRoute=o,e("Route handled successfully",o)}catch(t){console.error("Error handling route:",t)}},o.navigate=function(t,o={}){const e=Object.entries(o).map((([t,o])=>`${t}=${o}`)).join("|"),n=e?`${t}|${e}`:t;window.location.hash=n},o.getCurrentRoute=function(){return this.currentRoute},window.krouter=o,t(document).ready((()=>{void 0!==window.komponentor?o.options.autoInit&&o.init():console.error("Komponentor not found. Make sure komponentor.modern.js is loaded first.")}))}(jQuery);
//# sourceMappingURL=krouter.min.js.map
